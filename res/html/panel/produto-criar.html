<link rel="stylesheet" href="{$path}/res/css/slide-panel.css">
<header class="slidePanel-header">
  <div class="overlay-top overlay-panel overlay-background bg-indigo-600">
    <div class="slidePanel-actions btn-group btn-group-flat" aria-label="actions" role="group">      
      <button type="button" class="btn btn-pure slidePanel-close icon md-close" aria-hidden="true"></button>
    </div>
    <h4 class="stage-name"><h5 class="taskboard-stage-title text-uppercase">Criar novo Produto</h5></h4>
  </div>  
</header>

<div class="slidePanel-inner m-t-40">
	<form id="form-produto-save" class="slidePanel-form">	
		<div class="form-group">
		  	<div class="form-group form-material" data-plugin="formMaterial">
			    <label>Produto</label>
			    <input type="text" class="form-control" name="desproduto">
		  	</div>
		  	<div class="form-group form-material" data-plugin="formMaterial">
			    <label>Tipo de Produto</label>
			    <select name="idprodutotipo" class="form-control"></select>
		  	</div>
		  	<div class="form-group form-material" data-plugin="formMaterial">	  	
			    <label>Valor</label>
			    <input type="text" class="form-control" name="vlpreco">
		  	</div>
		  	<button class="btn btn-block btn-primary" id="btnProdutoSave" type="submit">Salvar Novo Produto</button>
		</div>
	</form>

</div>

<script>

	$("#form-produto-save [name=idprodutotipo]").combobox({
		debug:true,
		url:PATH+"/produtos/tipos",
		displayField:"desprodutotipo",
		valueField:"idprodutotipo"
	});

	var form = $("#form-produto-save");

  	form.form({
  		url:PATH+"/produtos",
  		params:{
  			idproduto:0,
  			idpreco:0,
  			inremovido:false
  		},
  		success:function(){

  			form.find("button#btnProdutoSave").btnload("unload");
  			System.success("Produto criado com sucesso");
  			$(".slidePanel-close").trigger("click");
  			$(".refresh").trigger("click");
  			loadProdutos();

  		},
  		failure:function(r){
  			form.find("button#btnProdutoSave").btnload("unload");
  			System.showError(r);
  		}
  	});

</script>