<link rel="stylesheet" href="{$path}/res/css/slide-panel.css">
<header class="slidePanel-header">
  <div class="overlay-top overlay-panel overlay-background bg-indigo-600">
    <div class="slidePanel-actions btn-group btn-group-flat" aria-label="actions" role="group">
      <button type="button" class="btn btn-pure slidePanel-close icon md-close" aria-hidden="true"></button>
    </div>
    <h4 class="stage-name"><h5 class="taskboard-stage-title text-uppercase">Forma de Pagamento {$formapagamento.desformapagamento}</h5></h4>
  </div>  
</header>

<div class="slidePanel-inner m-t-40">
  <form asutocomplete="off" id="form-forma-pagamento" class="slidePanel-form">
  	<div class="form-group form-material">
      <input type="hidden" name="idformapagamento" value="{$formapagamento.idformapagamento}">
      <label class="control-label" for="desformapagamento">Forma de Pagamento</label>
      <input type="text" class="form-control" name="desformapagamento">
		</div>
	  <div class="form-group form-material">	        
      <label class="control-label" for="idgateway">Gateway de Pagamento</label>
      <select name="idgateway" class="form-control" id="idgateway"></select>
    </div>
    <div class="form-group form-material">
      <label class="control-label" for="nrparcelasmax">Número máximo de parcelas</label>
      <input type="number" class="form-control" name="nrparcelasmax" />
    </div>
    <div class="form-group form-material">
      <input type="checkbox" class="icheckbox-primary" data-plugin="iCheck" data-checkbox-class="icheckbox_flat-blue" name="instatus" value="1" />
      <label class="control-label" for="instatus">Status</label>
    </div>
    <button type="submit" class="btn btn-block btn-primary" id="btn-forma-pagamento-salvar">Salvar</button>
  </form>
</div>

<script>

var formapagamento = JSON.parse('{function="json_encode($formapagamento)"}');

$("#idgateway").combobox({
	url:PATH+"/gateways/all",
	displayField:"desgateway",
	valueField:"idgateway",
	value:formapagamento.idgateway
});
  
var form = $("#form-forma-pagamento");

form.formLoad(formapagamento);

form.form({
  resetForm:false,
  url:PATH+"/formas-pagamentos",
  success:function(){

    form.find("button#btn-forma-pagamento-salvar").btnload("unload");
    System.success("Forma de Pagamento salva com sucesso");
    $("button.slidePanel-close").trigger("click");
    $(".refresh").trigger("click");

  },
  failure:function(r){

    form.find("button#btn-forma-pagamento-salvar").btnload("unload");
    System.showError(r);

  }
});

</script>