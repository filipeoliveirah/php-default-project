{include="panel-header"}
<div id="cupom-{$cupom.idcupom}">
    <header class="slidePanel-header">
        <div class="slidePanel-actions" aria-label="actions" role="group">
            <button type="button" class="btn btn-pure btn-inverse slidePanel-close actions-top icon wb-close"
            aria-hidden="true">
            </button>
        </div>
        <h1>
            Cupom {$cupom.descupom}
        </h1>
    </header>
    <div class="slidePanel-inner">
        <form asutocomplete="off" id="form-cupom" class="slidePanel-form">
            <div class="form-group form-material">
                <input type="hidden" name="idcupom" value="{$cupom.idcupom}">
                <label class="control-label" for="descupom">
                    Cupom
                </label>
                <input type="text" class="form-control" name="descupom" value="{$cupom.descupom}">
            </div>
            <div class="form-group form-material">
                <label class="control-label" for="idcupomtipo">
                    Tipo do cupom
                </label>
                <select name="idcupomtipo" class="form-control" id="idcupomtipo" value="{$cupom.idcupomtipo}">
                </select>
            </div>
            <div class="form-group form-material">
                <label>
                    Desconto
                </label>
                <input type="number" class="form-control" name="nrdesconto" value="{$cupom.nrdesconto}">
            </div>
            <div class="form-group form-material">
                <label>
                    Código
                </label>
                <input type="text" class="form-control" name="descodigo" value="{$cupom.descodigo}">
            </div>
            <div class="form-group form-material">
                <label>
                    Quantidade
                </label>
                <input type="text" class="form-control" name="nrqtd" value="{$cupom.nrqtd}">
            </div>
            <div class="form-group form-material">
                <label>
                    Início da Validade
                </label>
                <input type="text" class="form-control" name="dtinicio" value="{$cupom.dtinicio}">
            </div>
            <div class="form-group form-material">
                <label>
                    Término da Validade
                </label>
                <input type="text" class="form-control" name="dttermino" value="{$cupom.dttermino}">
            </div>
            <button type="submit" class="btn btn-block btn-primary" id="btn-cupom-salvar">
                Salvar
            </button>
        </form>
    </div>
</div>
<script>

var cupom = JSON.parse('{function="json_encode($cupom)"}');

$("[name=idcupomtipo]").combobox({
	url:PATH+"/cupons/tipos",
	displayField:"descupomtipo",
	valueField:"idcupomtipo",
	value:cupom.idcupomtipo
});
  
var form = $("#form-cupom");

form.form({
  resetForm:false,
  url:PATH+"/cupons",
  success:function(){

    form.find("button#btn-cupom-salvar").btnload("unload");
    System.success("Cupom salvo com sucesso");
    $("button.slidePanel-close").trigger("click");
    $(".refresh").trigger("click");

  },
  failure:function(r){

    form.find("button#btn-cupom-salvar").btnload("unload");
    System.showError(r);

  }
});

</script>